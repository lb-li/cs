import{_ as e,s as a,n as t,r as s,c as o,w as r,i as c,o as l,d as n,e as i,f as d,F as g,g as u,t as y,h,S as p,l as f,j as m}from"./index-CXYRgNF1.js";import{P as C,r as _}from"./page-loading.wY0R-w2q.js";const I=e({components:{PageLoading:C},data:()=>({categories:[],currentCategory:0,scrollTop:0,isLoading:!0}),onLoad(e){e.id&&(this.preSelectedId=parseInt(e.id)),this.loadCategories()},methods:{async loadCategories(){this.isLoading=!0;try{const e=await _({url:"/categories"});if(this.categories=e,this.preSelectedId){const e=this.categories.findIndex((e=>e.id===this.preSelectedId));-1!==e&&(this.currentCategory=e)}}catch(e){console.error("加载分类失败",e),a({title:"加载分类失败",icon:"none"})}finally{this.isLoading=!1}},switchCategory(e){this.currentCategory=e,this.scrollTop=0},goToProductList(e){t({url:`/pages/search/index?categoryId=${e.id}&categoryName=${encodeURIComponent(e.name)}`})}}},[["render",function(e,a,t,C,_,I){const L=c,k=p,w=s("u-image"),b=m,x=s("page-loading");return l(),o(L,{class:"container"},{default:r((()=>[n(L,{class:"category-container"},{default:r((()=>[n(k,{"scroll-y":"",class:"category-menu"},{default:r((()=>[(l(!0),i(g,null,d(_.categories,((e,a)=>(l(),o(L,{key:a,class:f(["menu-item",{active:_.currentCategory===a}]),onClick:e=>I.switchCategory(a)},{default:r((()=>[u(y(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),n(k,{"scroll-y":"",class:"category-content","scroll-top":_.scrollTop},{default:r((()=>[_.categories.length>0&&_.currentCategory>=0?(l(),i(g,{key:0},[n(L,{class:"category-banner"},{default:r((()=>[n(w,{src:_.categories[_.currentCategory].icon,width:"100%",height:"150rpx",mode:"aspectFill"},null,8,["src"]),n(L,{class:"banner-title"},{default:r((()=>[u(y(_.categories[_.currentCategory].name),1)])),_:1})])),_:1}),n(L,{class:"sub-category-list"},{default:r((()=>[(l(!0),i(g,null,d(_.categories[_.currentCategory].children,((e,a)=>(l(),o(L,{class:"sub-category-item",key:a,onClick:a=>I.goToProductList(e)},{default:r((()=>[n(L,{class:"sub-category-content"},{default:r((()=>[n(b,null,{default:r((()=>[u(y(e.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})],64)):h("",!0),n(x,{show:_.isLoading},null,8,["show"])])),_:1},8,["scroll-top"])])),_:1})])),_:1})}],["__scopeId","data-v-56b1a98a"]]);export{I as default};
