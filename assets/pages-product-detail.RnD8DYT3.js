import{_ as t,s,q as e,r as o,c as l,w as u,i as a,o as c,d as i,g as n,t as d,h as r,e as p,f,F as k,j as h,u as m,l as _}from"./index-CXYRgNF1.js";import{P as g,r as y}from"./page-loading.wY0R-w2q.js";const S=t({components:{PageLoading:g},data:()=>({productId:null,product:{},productImages:[],isLoading:!0,showSkuPopup:!1,skuGroups:[{title:"颜色",options:["红色","蓝色","黑色","白色"]},{title:"尺码",options:["S","M","L","XL","XXL"]}],selectedSkuValues:[],quantity:1,cartCount:2,buyType:""}),computed:{selectedSku(){return 0===this.selectedSkuValues.length?"请选择规格":this.selectedSkuValues.join("，")}},onLoad(t){t.id?(this.productId=parseInt(t.id),this.loadProductDetail()):(s({title:"商品ID不存在",icon:"none"}),setTimeout((()=>{e()}),1500))},methods:{async loadProductDetail(){this.isLoading=!0;try{const t=(await y({url:"/products"})).find((t=>t.id===this.productId));t?(this.product={...t,detail:`<p style="text-align: center;"><img src="${t.image}" style="max-width: 100%;"></p>\n                    <p>商品名称：${t.title}</p>\n                    <p>商品价格：${t.price}</p>\n                    <p>商品描述：这是一个高品质的商品，材质优良，做工精细，穿着舒适。</p>\n                    <p>温馨提示：洗涤时请注意不要使用漂白剂，不要长时间浸泡。</p>`},this.productImages=[{url:t.image},{url:"https://via.placeholder.com/750x750?text=Detail1"},{url:"https://via.placeholder.com/750x750?text=Detail2"}]):(s({title:"商品不存在",icon:"none"}),setTimeout((()=>{e()}),1500))}catch(t){console.error("加载商品详情失败",t),s({title:"加载商品详情失败",icon:"none"})}finally{this.isLoading=!1}},openSkuPopup(){this.showSkuPopup=!0},closeSkuPopup(){this.showSkuPopup=!1},selectSku(t,s){const e=[...this.selectedSkuValues];e[t]=s,this.selectedSkuValues=e},addToCart(){this.buyType="cart",this.openSkuPopup()},buyNow(){this.buyType="buy",this.openSkuPopup()},confirmAddToCart(){if(this.selectedSkuValues.length===this.skuGroups.length){if(!this.$common.isUserLoggedIn())return this.closeSkuPopup(),void this.$common.checkNeedLogin();this.$refs.uToast.show({title:"已加入购物车",type:"success"}),this.cartCount++,this.closeSkuPopup()}else this.$refs.uToast.show({title:"请选择完整规格",type:"warning"})},confirmBuyNow(){if(this.selectedSkuValues.length===this.skuGroups.length){if(!this.$common.isUserLoggedIn())return this.closeSkuPopup(),void this.$common.checkNeedLogin();this.$refs.uToast.show({title:"正在跳转到结算页面",type:"success"}),this.closeSkuPopup(),setTimeout((()=>{s({title:"结算功能开发中",icon:"none"})}),1500)}else this.$refs.uToast.show({title:"请选择完整规格",type:"warning"})}}},[["render",function(t,s,e,g,y,S){const b=o("u-swiper"),w=a,C=h,P=o("u-icon"),x=o("u-parse"),T=o("u-badge"),$=m,L=o("u-number-box"),I=o("u-popup"),V=o("page-loading"),v=o("u-toast");return c(),l(w,{class:"container"},{default:u((()=>[i(w,{class:"product-swiper"},{default:u((()=>[i(b,{list:y.productImages,keyName:"url",height:750,interval:3e3,indicator:!0,indicatorMode:"dot"},null,8,["list"])])),_:1}),i(w,{class:"product-info"},{default:u((()=>[i(w,{class:"product-price"},{default:u((()=>[i(C,{class:"price"},{default:u((()=>[n(d(t.$common.formatPrice(y.product.price)),1)])),_:1}),y.product.originalPrice?(c(),l(C,{key:0,class:"original-price"},{default:u((()=>[n(d(t.$common.formatPrice(y.product.originalPrice)),1)])),_:1})):r("",!0),y.product.discount?(c(),l(C,{key:1,class:"discount"},{default:u((()=>[n(d(y.product.discount)+"折",1)])),_:1})):r("",!0)])),_:1}),i(w,{class:"product-title"},{default:u((()=>[n(d(y.product.title),1)])),_:1}),i(w,{class:"product-stats"},{default:u((()=>[i(C,null,{default:u((()=>[n("销量 "+d(y.product.sales),1)])),_:1}),i(C,null,{default:u((()=>[n("库存 "+d(y.product.stock),1)])),_:1})])),_:1})])),_:1}),i(w,{class:"product-section",onClick:S.openSkuPopup},{default:u((()=>[i(w,{class:"section-title"},{default:u((()=>[n("规格")])),_:1}),i(w,{class:"section-content"},{default:u((()=>[i(C,{class:"section-text"},{default:u((()=>[n("请选择规格")])),_:1}),i(P,{name:"arrow-right",color:"#999",size:"28rpx"})])),_:1})])),_:1},8,["onClick"]),i(w,{class:"product-section"},{default:u((()=>[i(w,{class:"section-title"},{default:u((()=>[n("商品详情")])),_:1}),i(w,{class:"product-detail"},{default:u((()=>[i(x,{content:y.product.detail||"暂无详情"},null,8,["content"])])),_:1})])),_:1}),i(w,{class:"bottom-bar"},{default:u((()=>[i(w,{class:"bar-item"},{default:u((()=>[i(P,{name:"home",size:"40rpx",color:"#666"}),i(C,null,{default:u((()=>[n("首页")])),_:1})])),_:1}),i(w,{class:"bar-item"},{default:u((()=>[i(P,{name:"star",size:"40rpx",color:"#666"}),i(C,null,{default:u((()=>[n("收藏")])),_:1})])),_:1}),i(w,{class:"bar-item"},{default:u((()=>[i(P,{name:"shopping-cart",size:"40rpx",color:"#666"}),i(C,null,{default:u((()=>[n("购物车")])),_:1}),y.cartCount>0?(c(),l(T,{key:0,count:y.cartCount,offset:[-8,-8]},null,8,["count"])):r("",!0)])),_:1}),i(w,{class:"bar-btn add-cart-btn",onClick:S.addToCart},{default:u((()=>[n("加入购物车")])),_:1},8,["onClick"]),i(w,{class:"bar-btn buy-now-btn",onClick:S.buyNow},{default:u((()=>[n("立即购买")])),_:1},8,["onClick"])])),_:1}),i(I,{show:y.showSkuPopup,mode:"bottom",onClose:S.closeSkuPopup},{default:u((()=>[i(w,{class:"sku-popup"},{default:u((()=>[i(w,{class:"sku-header"},{default:u((()=>[i($,{class:"sku-image",src:y.product.image,mode:"aspectFill"},null,8,["src"]),i(w,{class:"sku-info"},{default:u((()=>[i(w,{class:"sku-price"},{default:u((()=>[n(d(t.$common.formatPrice(y.product.price)),1)])),_:1}),i(w,{class:"sku-selected"},{default:u((()=>[n("已选："+d(S.selectedSku),1)])),_:1})])),_:1}),i(P,{name:"close",onClick:S.closeSkuPopup,class:"close-icon"},null,8,["onClick"])])),_:1}),i(w,{class:"sku-content"},{default:u((()=>[(c(!0),p(k,null,f(y.skuGroups,((t,s)=>(c(),l(w,{class:"sku-group",key:s},{default:u((()=>[i(w,{class:"sku-group-title"},{default:u((()=>[n(d(t.title),1)])),_:2},1024),i(w,{class:"sku-options"},{default:u((()=>[(c(!0),p(k,null,f(t.options,((t,e)=>(c(),l(w,{class:_(["sku-option",{active:y.selectedSkuValues[s]===t}]),key:e,onClick:e=>S.selectSku(s,t)},{default:u((()=>[n(d(t),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)),i(w,{class:"sku-quantity"},{default:u((()=>[i(w,{class:"quantity-title"},{default:u((()=>[n("数量")])),_:1}),i(L,{modelValue:y.quantity,"onUpdate:modelValue":s[0]||(s[0]=t=>y.quantity=t),min:1,max:y.product.stock},null,8,["modelValue","max"])])),_:1})])),_:1}),i(w,{class:"sku-footer"},{default:u((()=>[i(w,{class:"sku-btn add-cart-btn",onClick:S.confirmAddToCart},{default:u((()=>[n("加入购物车")])),_:1},8,["onClick"]),i(w,{class:"sku-btn buy-now-btn",onClick:S.confirmBuyNow},{default:u((()=>[n("立即购买")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["show","onClose"]),i(V,{show:y.isLoading},null,8,["show"]),i(v,{ref:"uToast"},null,512)])),_:1})}],["__scopeId","data-v-c279043c"]]);export{S as default};
